<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script> <!--On hover interactions-->
    <meta charset="utf-8" />
    <title>GeoJson Model Test</title>

</head>

<body>

    <script>
        var transData = [
            ["01 Mar - 07 Mar", "08 Mar - 14 Mar", "15 Mar - 21 Mar", "22 Mar - 28 Mar", "29 Mar - 04 Apr", "05 Apr - 11 Apr", "12 Apr - 18 Apr", "19 Apr - 25 Apr", "26 Apr - 02 May", "03 May - 09 May", "10 May - 14 May"],
            [2.9, 2.9, 4.3, 8.6, 8.6, 24.3, 30.0, 94.2, 91.4, 127.1, 77.1],
            [5.1, 3.4, 5.1, 6.0, 6.0, 12.8, 8.5, 37.5, 52.0, 62.1, 68.3],
            [2.4, 10.4, 10.4, 19.3, 28.1, 24.1, 26.5, 58.6, 32.1, 57.0, 65.0]];

        var angExtr = 0.1;
        var gwynExtr = 0.1;
        var conExtr = 0.1;
        var date = "Date";

        var anglesey = d3.select("#anglesey");
        var gwynedd = d3.select("#gwynedd");
        var conwy = d3.select("#conwy");

        AFRAME.registerComponent('ang', {
            update: function () {
                var x = 0,
                    y = 0;
                let points = [];
                points.push(new THREE.Vector2(-12, 32));
                points.push(new THREE.Vector2(-9, 34));
                points.push(new THREE.Vector2(-8, 35));
                points.push(new THREE.Vector2(-9, 35));
                points.push(new THREE.Vector2(-10, 37));
                points.push(new THREE.Vector2(-13, 37));
                points.push(new THREE.Vector2(-14, 35));
                points.push(new THREE.Vector2(-16, 35));


                for (var i = 0; i < points.length; i++) {
                    points[i].multiplyScalar(0.25);
                }
                var shape = new THREE.Shape(points);


                var extrudedGeometry = new THREE.ExtrudeGeometry(shape, {
                    amount: angExtr,
                    bevelEnabled: false
                });

                // Geometry doesn't do much on its own, we need to create a Mesh from it
                var extrudedMesh = new THREE.Mesh(extrudedGeometry, new THREE.MeshPhongMaterial({
                    color: 0xff0000
                }));
                this.el.object3D.add(extrudedMesh);

                var geometry = new THREE.ShapeGeometry(shape);
                var material = new THREE.MeshBasicMaterial({
                    color: 0x00ff00
                });
                var mesh = new THREE.Mesh(geometry, material);
                this.el.object3D.add(mesh);
            }
        });
        AFRAME.registerComponent('gwy', {
            update: function () {
                var x = 0,
                    y = 0;
                let points = [];
                points.push(new THREE.Vector2(-14, 21));
                points.push(new THREE.Vector2(-13, 22));
                points.push(new THREE.Vector2(-14, 24));
                points.push(new THREE.Vector2(-13, 26));
                points.push(new THREE.Vector2(-14, 27));
                points.push(new THREE.Vector2(-13, 27.5));
                points.push(new THREE.Vector2(-15, 28));
                points.push(new THREE.Vector2(-11, 27));
                points.push(new THREE.Vector2(-10.5, 26.5));
                points.push(new THREE.Vector2(-11, 26));
                points.push(new THREE.Vector2(-10.5, 25.5));
                points.push(new THREE.Vector2(-9, 26));
                points.push(new THREE.Vector2(-7, 26));
                points.push(new THREE.Vector2(-9, 28));
                points.push(new THREE.Vector2(-9.5, 28));
                points.push(new THREE.Vector2(-11, 30));
                points.push(new THREE.Vector2(-13, 32.5));
                points.push(new THREE.Vector2(-15, 34));
                points.push(new THREE.Vector2(-16, 33));
                points.push(new THREE.Vector2(-15, 31));
                points.push(new THREE.Vector2(-15, 30));
                points.push(new THREE.Vector2(-16, 29));
                points.push(new THREE.Vector2(-17, 29));
                points.push(new THREE.Vector2(-18, 28));
                points.push(new THREE.Vector2(-18, 29));
                points.push(new THREE.Vector2(-20, 29));
                points.push(new THREE.Vector2(-21, 28));
                points.push(new THREE.Vector2(-21, 26));
                points.push(new THREE.Vector2(-20, 25));
                points.push(new THREE.Vector2(-20, 23));
                points.push(new THREE.Vector2(-17, 22));
                points.push(new THREE.Vector2(-16, 21));

                for (var i = 0; i < points.length; i++) {
                    points[i].multiplyScalar(0.25);
                }
                var shape = new THREE.Shape(points);


                var extrudedGeometry = new THREE.ExtrudeGeometry(shape, {
                    amount: gwynExtr,
                    bevelEnabled: false
                });

                // Geometry doesn't do much on its own, we need to create a Mesh from it
                var extrudedMesh = new THREE.Mesh(extrudedGeometry, new THREE.MeshPhongMaterial({
                    color: 0x3c870e
                }));
                this.el.object3D.add(extrudedMesh);

                var geometry = new THREE.ShapeGeometry(shape);
                var material = new THREE.MeshBasicMaterial({
                    color: 0x3c870e
                });
                var mesh = new THREE.Mesh(geometry, material);
                this.el.object3D.add(mesh);
            }
        });
        AFRAME.registerComponent('con', {
            update: function () {
                var x = 0,
                    y = 0;
                let points = [];

                points.push(new THREE.Vector2(-20, 29));//con bord end
                points.push(new THREE.Vector2(-18, 29));
                points.push(new THREE.Vector2(-18, 28));
                points.push(new THREE.Vector2(-17, 29));
                points.push(new THREE.Vector2(-16, 29));
                points.push(new THREE.Vector2(-15, 30));
                points.push(new THREE.Vector2(-15, 31));
                points.push(new THREE.Vector2(-16, 33));
                points.push(new THREE.Vector2(-15, 34));//con bord strt
                points.push(new THREE.Vector2(-16, 34.5));
                points.push(new THREE.Vector2(-16, 35));
                points.push(new THREE.Vector2(-17, 34.5));
                points.push(new THREE.Vector2(-18, 34.5));
                points.push(new THREE.Vector2(-19, 35));
                points.push(new THREE.Vector2(-19, 33));
                points.push(new THREE.Vector2(-20, 32));
                points.push(new THREE.Vector2(-20, 31));
                points.push(new THREE.Vector2(-18, 29));
                points.push(new THREE.Vector2(-19, 29));


                for (var i = 0; i < points.length; i++) {
                    points[i].multiplyScalar(0.25);
                }
                var shape = new THREE.Shape(points);


                var extrudedGeometry = new THREE.ExtrudeGeometry(shape, {
                    amount: conExtr,
                    bevelEnabled: false
                });

                // Geometry doesn't do much on its own, we need to create a Mesh from it
                var extrudedMesh = new THREE.Mesh(extrudedGeometry, new THREE.MeshPhongMaterial({
                    color: 0x0383ad
                }));
                this.el.object3D.add(extrudedMesh);

                var geometry = new THREE.ShapeGeometry(shape);
                var material = new THREE.MeshBasicMaterial({
                    color: 0x0383ad
                });
                var mesh = new THREE.Mesh(geometry, material);
                this.el.object3D.add(mesh);
            }
        });
        var date = d3.select("#date")
        var counter = 0;
        var timer;
        function startSim() {
            timer = setInterval(myClock, 1000);
            function myClock() {
                counter++;
                if (counter == 0) {
                    clearInterval(transData[0].length);
                    alert("Reached zero");
                }
            }
        }
        function forwardSim() {
            counter++;
            runSim();
            console.log(counter);

        }
        function stopSim() {
            clearInterval(timer);
        }
            function reverseSim() {
                counter--;
                runSim();
                console.log(counter);
        }
        function runSim() {
            console.log(anglesey.getAttribute('ang'));
            angExtr = 0.1 * transData[1][counter];
            conExtr = 0.1 * transData[2][counter];
            gwynExtr = 0.1 * transData[3][counter];
            date.innnerHTML = transData[0][counter];
            console.log(transData[0][counter]);

        }
        angExtr = 0.1 * transData[1][4];
        conExtr = 0.1 * 8.6
        console.log(angExtr);
    </script>
    <div>
        <h1>Test 17</h1>
    </div>
    <a-scene>
        <a-entity position="0 0 0" depth="4" rotation="90 0 180" ang id="anglesey"></a-entity>
        <a-entity position="0 0 0" rotation="90 0 180" gwy id="gwynedd"></a-entity>
        <a-entity position="0 0 0" rotation="90 0 180" con id="conwy"></a-entity>

    </a-scene>

    <div style='position: fixed; bottom: 10px; width:100%; text-align: center; z-index: 1;'>
        <button onclick="reverseSim()"><</button>
        <button onclick="stopSim()">||</button>
        <button onclick="forwardSim()">></button>

        <h1 id="date">Date</h1>
    </div>
</body>
</html>
